{"version":3,"file":"main.slw-cannaunion.bundle.js","mappings":"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","sources":["webpack://slw-cannaunion/./src/checkout.js","webpack://slw-cannaunion/webpack/bootstrap","webpack://slw-cannaunion/webpack/runtime/compat get default export","webpack://slw-cannaunion/webpack/runtime/define property getters","webpack://slw-cannaunion/webpack/runtime/hasOwnProperty shorthand","webpack://slw-cannaunion/./src/main.js"],"sourcesContent":["/**\r\n * Checkout\r\n *\r\n */\r\n\r\n;((w, $) => {\r\n  'use strict';\r\n\r\n  const setCountryFieldHandle = ($countryField) => {\r\n    // Change to country by Client IP\r\n    if(w.SLW_Store.country_code) {\r\n      $countryField.val(w.SLW_Store.country_code).trigger('change');\r\n    }\r\n\r\n    // Disable field if store is private\r\n    if(w.SLW_Store.access_store == 'private') {\r\n      // $countryField.prop('disabled', true);\r\n      $countryField\r\n        .next('.select2')\r\n        .addClass('__non-select');\r\n    } else {\r\n      const privateStores = PHP_DATA?.product_locations?.filter(store => {\r\n        return store.access_store == 'private';\r\n      })\r\n\r\n      if(!privateStores) return;\r\n\r\n      privateStores.forEach(item => {\r\n        $countryField.find(`option[value=${item.country_code}]`).prop('disabled', true);\r\n      });\r\n\r\n      // $countryField.select2('refresh')\r\n    }\r\n  }\r\n\r\n  const resetCountryField = ($countryField) => {\r\n    if(w.SLW_Store.access_store == 'private') {\r\n      // $countryField.prop('disabled', false);\r\n      $countryField\r\n        .next('.select2')\r\n        .removeClass('__non-select');\r\n    } else {\r\n      const privateStores = PHP_DATA?.product_locations?.filter(store => {\r\n        return store.access_store == 'private';\r\n      })\r\n\r\n      if(!privateStores) return;\r\n\r\n      privateStores.forEach(item => {\r\n        $countryField.find(`option[value=${item.country_code}]`).prop('disabled', false);\r\n      });\r\n\r\n      // $countryField.select2('refresh')\r\n    }\r\n  }\r\n\r\n  const setDefaultCountryField = () => {\r\n    let shipDifferentAddressCheckbox = document.querySelector('#ship-to-different-address-checkbox');\r\n    let countryField = document.querySelector('form.woocommerce-checkout select[name=\"billing_country\"]');\r\n    let countryField2 = document.querySelector('form.woocommerce-checkout select[name=\"shipping_country\"]');\r\n    if(!countryField) return;\r\n\r\n    if(shipDifferentAddressCheckbox) {\r\n      shipDifferentAddressCheckbox.addEventListener('change', e => {\r\n        if(e.target.checked == true) {\r\n          // custom shipping address\r\n          resetCountryField($(countryField)); // reset\r\n          setCountryFieldHandle($(countryField2)); // apply validate Country\r\n        } else {\r\n          // billing address\r\n          if(countryField2) {\r\n            resetCountryField($(countryField2)); // reset\r\n          }\r\n          setCountryFieldHandle($(countryField)); // apply validate Country\r\n        }\r\n      })\r\n    }\r\n\r\n    setCountryFieldHandle($(countryField));\r\n  }\r\n\r\n  var disableBtnCheckout;\r\n  const warrningDialogUpdateLocationPrivate = () => {\r\n    let $shipDifferentAddressCheckbox = $('#ship-to-different-address-checkbox');\r\n    let $countryField = $('form.woocommerce-checkout select[name=\"billing_country\"]');\r\n    let $countryField2 = $('form.woocommerce-checkout select[name=\"shipping_country\"]');\r\n    let $formCheckout = $('form.woocommerce-checkout');\r\n    //console.log($formCheckout);\r\n    if(!$countryField) return;\r\n    const alertMessage = (countryCode) => {\r\n      if(PHP_DATA.site_code === 'uk' && countryCode == 'GB') return;\r\n      if(PHP_DATA.site_code === 'eu' && countryCode != 'GB') return;\r\n      $.alert({\r\n        title: '⚠️ Warning.',\r\n        content: PHP_DATA.slwc_message_warning_checkout_page,\r\n        useBootstrap: false,\r\n        type: 'red',\r\n      });\r\n      $formCheckout.find('#place_order').prop('disabled', true);\r\n      disableBtnCheckout = setInterval(disableBN, 1000);\r\n    }\r\n\r\n    // if(w.SLW_Store.country_code) {\r\n    //   $countryField.val(w.SLW_Store.country_code).trigger('change');\r\n    // }\r\n\r\n    //if(w.SLW_Store.access_store !== 'private') return;\r\n\r\n    $countryField.on('change', function(e) {\r\n      //if($shipDifferentAddressCheckbox.prop('checked') == true) return;\r\n      //alertMessage(this.value);\r\n      $formCheckout.find('#place_order').prop('disabled', false);\r\n    })\r\n\r\n    $countryField2.on('change', function(e) {\r\n      $formCheckout.find('#place_order').prop('disabled', false);\r\n      alertMessage(this.value);\r\n    });\r\n\r\n    $formCheckout.submit(function(){\r\n      if($shipDifferentAddressCheckbox.prop('checked') == true) return;\r\n      alertMessage($countryField.val());\r\n    });\r\n\r\n    function disableBN() {\r\n      if(!$(document).find('.blockOverlay').length){\r\n        $formCheckout.find('#place_order').prop('disabled', true);\r\n        clearInterval(disableBtnCheckout);\r\n      }\r\n    }\r\n\r\n\r\n  }\r\n\r\n  document.addEventListener('DOMContentLoaded', () => {\r\n    //\r\n  })\r\n\r\n  w.addEventListener('load', () => {\r\n    // setDefaultCountryField();\r\n\r\n    // warrning message if location private\r\n    warrningDialogUpdateLocationPrivate();\r\n  })\r\n})(window, jQuery)\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","/**\r\n * Main Javscript\r\n */\r\nimport * as Helpers from './helpers';\r\nimport './checkout';\r\nimport './main.scss';\r\n\r\n;((w, $) => {\r\n  'use strict';\r\n  w.SLW_Store = null;\r\n  const AllStore = PHP_DATA.product_locations;\r\n  const {countryCode, country, timezone} = PHP_DATA.user_location;\r\n\r\n  const defineClientStoreValue = () => {\r\n    const _found = AllStore.find(store => {\r\n      return (store.country_code == countryCode)\r\n    })\r\n\r\n    return _found ? _found : AllStore.find(store => {\r\n      return (store.access_store == 'global')\r\n    })\r\n  }\r\n\r\n  const updateTextNearbyLocationSelect = (select) => {\r\n    const $wrap = $(select).parent();\r\n    const $opt = $(select).find(`option[value=\"${select.value}\"]`);\r\n    const text = $opt.length ? $opt.text() : `Product not available.`;\r\n    const locationItem = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M12 0c-4.198 0-8 3.403-8 7.602 0 4.198 3.469 9.21 8 16.398 4.531-7.188 8-12.2 8-16.398 0-4.199-3.801-7.602-8-7.602zm0 11c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3z\"/></svg>`;\r\n\r\n    $wrap.find('.slwc-text').remove();\r\n    $wrap.prepend(`<div class=\"slwc-text\">${locationItem} ${text}</div>`);\r\n  }\r\n\r\n  const validateQtyAfterLocalSelectUpdate = (select) => {\r\n    const $select = $(select);\r\n    const $form = $select.parents('form');\r\n    const $opt = $select.find(`option[value=\"${select.value}\"]`);\r\n\r\n    if($opt.length === 0 || $opt[0].disabled === true) {\r\n      $form\r\n        .find('button[type=submit], input[name=quantity]')\r\n        .addClass('slwc-field-disable-css');\r\n    } else {\r\n      $form\r\n        .find('button[type=submit], input[name=quantity]')\r\n        .removeClass('slwc-field-disable-css');\r\n    }\r\n  }\r\n\r\n  const storeSelected = () => {\r\n    const selectQuery = ['form.cart select.slw_item_stock_location']; // Product page,\r\n    const selectFields = document.querySelectorAll(selectQuery.join(','));\r\n    if(selectFields.length <= 0) {\r\n      $('.single-product form.cart').addClass('slwc-field-disable-css');\r\n      return;\r\n    };\r\n\r\n    // Add onChang event\r\n    $(selectQuery.join(',')).off('change').on('change', function(e) {\r\n      updateTextNearbyLocationSelect(this);\r\n      validateQtyAfterLocalSelectUpdate(this);\r\n    })\r\n\r\n    selectFields.forEach(select => {\r\n      select.classList.add('slwc-custom');\r\n      select.value = w.SLW_Store.term_id;\r\n\r\n      $(select).trigger('change'); // trigger onChange event to update something\r\n      select.classList.add('slwc-field-disable-css', 'noselect'); // disable field\r\n    })\r\n  }\r\n\r\n  const stockLocationSelectFieldUpdate = () => {\r\n    $(document).ajaxComplete((event, request, settings) => {\r\n      if(settings?.data.startsWith('action=get_variation_locations')) {\r\n        storeSelected();\r\n      }\r\n    })\r\n  }\r\n\r\n  const productVariableUpdate = () => {\r\n    $('.variations_form').on('found_variation', e => {\r\n      // console.log('Mike log');\r\n    });\r\n  }\r\n\r\n  const buttonAddToCart2 = () => {\r\n    const Buttons = $('.button.product_type_simple.add_to_cart_button.ajax_add_to_cart');\r\n\r\n    Buttons.each((_, b) => {\r\n      b.classList.add('slwc-hidden');\r\n\r\n      const product_id = parseInt(b.dataset.product_id);\r\n      const isUnavailable = $(b).parents('.__slwc-product-unavailable').length;\r\n\r\n      const ButtonClone = $(`<a class=\"button slwc-custom-button-ajax-add-to-cart-simple-product ${isUnavailable ? 'slwc-field-disable-css' : ''}\" href=\"javascript:\" data-product-id=\"${product_id}\">${b.text}</a>`);\r\n      $(b).before([isUnavailable ? `<small class=\"product-unavailable-tag\">Unavailable for your location</small>` : '', ButtonClone]);\r\n      b.href = `${b.href}&slw_add_to_cart_item_stock_location=${SLW_Store.term_id}`;\r\n    })\r\n\r\n    $(document.body).on('click', 'a.slwc-custom-button-ajax-add-to-cart-simple-product', function(e) {\r\n      e.preventDefault();\r\n      const $button = $(this);\r\n      const product_id = parseInt($(this).data('product-id'));\r\n      $button.addClass('loading');\r\n\r\n      $.ajax({\r\n        type: 'POST',\r\n        url: '?wc-ajax=add_to_cart',\r\n        data: {\r\n          // product_id,\r\n          'add-to-cart': product_id,\r\n          // quantity: 1,\r\n          slw_add_to_cart_item_stock_location: SLW_Store.term_id,\r\n        },\r\n        success() {\r\n          $(document.body).trigger('wc_fragment_refresh');\r\n          setTimeout(() => {\r\n            $button.removeClass('loading');\r\n          }, 1500)\r\n        },\r\n        error(e) {\r\n          console.log(e)\r\n        }\r\n      })\r\n    })\r\n  }\r\n\r\n  const outofstockHandle = () => {\r\n    $('.product.type-product').each(function() {\r\n      if($(this).find('.product-unavailable-tag').length > 0) return;\r\n      if($(this).hasClass(`__slwc-qty-${w.SLW_Store.term_id}_0`)) {\r\n        $(this).append(`<small class=\"product-unavailable-tag\">Out of stock</small>`);\r\n      }\r\n    })\r\n  }\r\n\r\n  const _Init = () => {\r\n    w.SLW_Store = defineClientStoreValue(); // get Store\r\n    storeSelected();\r\n    productVariableUpdate();\r\n    stockLocationSelectFieldUpdate();\r\n    buttonAddToCart2();\r\n    outofstockHandle();\r\n  }\r\n\r\n  w.addEventListener('DOMContentLoaded', e => {\r\n    if(PHP_DATA.site_code == '') _Init();\r\n  })\r\n})(window, jQuery)\r\n"],"names":["w","$","disableBtnCheckout","warrningDialogUpdateLocationPrivate","$shipDifferentAddressCheckbox","$countryField","$countryField2","$formCheckout","alertMessage","countryCode","PHP_DATA","site_code","alert","title","content","slwc_message_warning_checkout_page","useBootstrap","type","find","prop","setInterval","disableBN","document","length","clearInterval","on","e","this","value","submit","val","addEventListener","window","jQuery","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prototype","hasOwnProperty","call","SLW_Store","AllStore","product_locations","country","timezone","user_location","storeSelected","selectQuery","selectFields","querySelectorAll","join","addClass","off","select","$wrap","parent","$opt","text","remove","prepend","updateTextNearbyLocationSelect","$select","$form","parents","disabled","removeClass","validateQtyAfterLocalSelectUpdate","forEach","classList","add","term_id","trigger","buttonAddToCart2","each","_","b","product_id","parseInt","dataset","isUnavailable","ButtonClone","before","href","body","preventDefault","$button","data","ajax","url","slw_add_to_cart_item_stock_location","success","setTimeout","error","console","log","outofstockHandle","hasClass","append","store","country_code","access_store","ajaxComplete","event","request","settings","startsWith"],"sourceRoot":""}
