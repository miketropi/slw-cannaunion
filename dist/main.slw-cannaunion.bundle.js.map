{"version":3,"file":"main.slw-cannaunion.bundle.js","mappings":"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","sources":["webpack://slw-cannaunion/./src/checkout.js","webpack://slw-cannaunion/webpack/bootstrap","webpack://slw-cannaunion/webpack/runtime/compat get default export","webpack://slw-cannaunion/webpack/runtime/define property getters","webpack://slw-cannaunion/webpack/runtime/hasOwnProperty shorthand","webpack://slw-cannaunion/./src/main.js"],"sourcesContent":["/**\n * Checkout\n *\n */\n\n;((w, $) => {\n  'use strict';\n  const setCountryFieldHandle = ($countryField) => {\n    // Change to country by Client IP\n    if(w.SLW_Store.country_code) {\n      $countryField.val(w.SLW_Store.country_code).trigger('change');\n    }\n\n    // Disable field if store is private\n    if(w.SLW_Store.access_store == 'private') {\n      // $countryField.prop('disabled', true);\n      $countryField\n        .next('.select2')\n        .addClass('__non-select');\n    } else {\n      const privateStores = PHP_DATA?.product_locations?.filter(store => {\n        return store.access_store == 'private';\n      })\n\n      if(!privateStores) return;\n\n      privateStores.forEach(item => {\n        $countryField.find(`option[value=${item.country_code}]`).prop('disabled', true);\n      });\n\n      // $countryField.select2('refresh')\n    }\n  }\n\n  const resetCountryField = ($countryField) => {\n    if(w.SLW_Store.access_store == 'private') {\n      // $countryField.prop('disabled', false);\n      $countryField\n        .next('.select2')\n        .removeClass('__non-select');\n    } else {\n      const privateStores = PHP_DATA?.product_locations?.filter(store => {\n        return store.access_store == 'private';\n      })\n\n      if(!privateStores) return;\n\n      privateStores.forEach(item => {\n        $countryField.find(`option[value=${item.country_code}]`).prop('disabled', false);\n      });\n\n      // $countryField.select2('refresh')\n    }\n  }\n\n  const setDefaultCountryField = () => {\n    let shipDifferentAddressCheckbox = document.querySelector('#ship-to-different-address-checkbox');\n    let countryField = document.querySelector('form.woocommerce-checkout select[name=\"billing_country\"]');\n    let countryField2 = document.querySelector('form.woocommerce-checkout select[name=\"shipping_country\"]');\n    if(!countryField) return;\n\n    if(shipDifferentAddressCheckbox) {\n      shipDifferentAddressCheckbox.addEventListener('change', e => {\n        if(e.target.checked == true) {\n          // custom shipping address\n          resetCountryField($(countryField)); // reset\n          setCountryFieldHandle($(countryField2)); // apply validate Country\n        } else {\n          // billing address\n          if(countryField2) {\n            resetCountryField($(countryField2)); // reset\n          }\n          setCountryFieldHandle($(countryField)); // apply validate Country\n        }\n      })\n    }\n\n    setCountryFieldHandle($(countryField));\n  }\n\n  var disableBtnCheckout;\n  const warrningDialogUpdateLocationPrivate = () => {\n    let $shipDifferentAddressCheckbox = $('#ship-to-different-address-checkbox');\n    let $countryField = $('form.woocommerce-checkout select[name=\"billing_country\"]');\n    let $countryField2 = $('form.woocommerce-checkout select[name=\"shipping_country\"]');\n    let $formCheckout = $('form.woocommerce-checkout');\n    //console.log($formCheckout);\n    if(!$countryField) return;\n    const alertMessage = (countryCode) => {\n      if(PHP_DATA.site_code === 'uk' && countryCode == 'GB') return;\n      if(PHP_DATA.site_code === 'eu' && countryCode != 'GB') return;\n      $.alert({\n        title: '⚠️ Warning.',\n        content: PHP_DATA.slwc_message_warning_checkout_page,\n        useBootstrap: false,\n        type: 'red',\n      });\n      $formCheckout.find('#place_order').prop('disabled', true);\n      disableBtnCheckout = setInterval(disableBN, 1000);\n    }\n\n    // if(w.SLW_Store.country_code) {\n    //   $countryField.val(w.SLW_Store.country_code).trigger('change');\n    // }\n\n    //if(w.SLW_Store.access_store !== 'private') return;\n\n    $countryField.on('change', function(e) {\n      //if($shipDifferentAddressCheckbox.prop('checked') == true) return;\n      //alertMessage(this.value);\n      $formCheckout.find('#place_order').prop('disabled', false);\n    })\n\n    $countryField2.on('change', function(e) {\n      $formCheckout.find('#place_order').prop('disabled', false);\n      alertMessage(this.value);\n    });\n\n    $formCheckout.submit(function(){\n      if($shipDifferentAddressCheckbox.prop('checked') == true) return;\n      alertMessage($countryField.val());\n    });\n\n    function disableBN() {\n      if(!$(document).find('.blockOverlay').length){\n        $formCheckout.find('#place_order').prop('disabled', true);\n        clearInterval(disableBtnCheckout);\n      }\n    }\n\n\n  }\n\n  document.addEventListener('DOMContentLoaded', () => {\n    //\n  })\n\n  w.addEventListener('load', () => {\n    // setDefaultCountryField();\n\n    // warrning message if location private\n    warrningDialogUpdateLocationPrivate();\n  })\n})(window, jQuery)\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","/**\n * Main Javscript\n */\nimport * as Helpers from './helpers';\nimport './checkout';\nimport './main.scss';\n\n;((w, $) => {\n  'use strict';\n  w.SLW_Store = null;\n  const AllStore = PHP_DATA.product_locations;\n  const {countryCode, country, timezone} = PHP_DATA.user_location;\n\n  const defineClientStoreValue = () => {\n    const _found = AllStore.find(store => {\n      return (store.country_code == countryCode)\n    })\n\n    return _found ? _found : AllStore.find(store => {\n      return (store.access_store == 'global')\n    })\n  }\n\n  const updateTextNearbyLocationSelect = (select) => {\n    const $wrap = $(select).parent();\n    const $opt = $(select).find(`option[value=\"${select.value}\"]`);\n    const text = $opt.length ? $opt.text() : `Product not available.`;\n    const locationItem = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M12 0c-4.198 0-8 3.403-8 7.602 0 4.198 3.469 9.21 8 16.398 4.531-7.188 8-12.2 8-16.398 0-4.199-3.801-7.602-8-7.602zm0 11c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3z\"/></svg>`;\n\n    $wrap.find('.slwc-text').remove();\n    $wrap.prepend(`<div class=\"slwc-text\">${locationItem} ${text}</div>`);\n  }\n\n  const validateQtyAfterLocalSelectUpdate = (select) => {\n    const $select = $(select);\n    const $form = $select.parents('form');\n    const $opt = $select.find(`option[value=\"${select.value}\"]`);\n\n    if($opt.length === 0 || $opt[0].disabled === true) {\n      $form\n        .find('button[type=submit], input[name=quantity]')\n        .addClass('slwc-field-disable-css');\n    } else {\n      $form\n        .find('button[type=submit], input[name=quantity]')\n        .removeClass('slwc-field-disable-css');\n    }\n  }\n\n  const storeSelected = () => {\n    const selectQuery = ['form.cart select.slw_item_stock_location']; // Product page,\n    const selectFields = document.querySelectorAll(selectQuery.join(','));\n    if(selectFields.length <= 0) {\n      $('.single-product form.cart').addClass('slwc-field-disable-css');\n      return;\n    };\n\n    // Add onChang event\n    $(selectQuery.join(',')).off('change').on('change', function(e) {\n      updateTextNearbyLocationSelect(this);\n      validateQtyAfterLocalSelectUpdate(this);\n    })\n\n    selectFields.forEach(select => {\n      select.classList.add('slwc-custom');\n      select.value = w.SLW_Store.term_id;\n\n      $(select).trigger('change'); // trigger onChange event to update something\n      select.classList.add('slwc-field-disable-css', 'noselect'); // disable field\n    })\n  }\n\n  const stockLocationSelectFieldUpdate = () => {\n    $(document).ajaxComplete((event, request, settings) => {\n      if(settings?.data.startsWith('action=get_variation_locations')) {\n        storeSelected();\n      }\n    })\n  }\n\n  const productVariableUpdate = () => {\n    $('.variations_form').on('found_variation', e => {\n      // console.log('Mike log');\n    });\n  }\n\n  const buttonAddToCart2 = () => {\n    const Buttons = $('.button.product_type_simple.add_to_cart_button.ajax_add_to_cart');\n\n    Buttons.each((_, b) => {\n      b.classList.add('slwc-hidden');\n\n      const product_id = parseInt(b.dataset.product_id);\n      const isUnavailable = $(b).parents('.__slwc-product-unavailable').length;\n\n      const ButtonClone = $(`<a class=\"button slwc-custom-button-ajax-add-to-cart-simple-product ${isUnavailable ? 'slwc-field-disable-css' : ''}\" href=\"javascript:\" data-product-id=\"${product_id}\">${b.text}</a>`);\n      $(b).before([isUnavailable ? `<small class=\"product-unavailable-tag\">Unavailable for your location</small>` : '', ButtonClone]);\n      b.href = `${b.href}&slw_add_to_cart_item_stock_location=${SLW_Store.term_id}`;\n    })\n\n    $(document.body).on('click', 'a.slwc-custom-button-ajax-add-to-cart-simple-product', function(e) {\n      e.preventDefault();\n      const $button = $(this);\n      const product_id = parseInt($(this).data('product-id'));\n      $button.addClass('loading');\n\n      $.ajax({\n        type: 'POST',\n        url: '?wc-ajax=add_to_cart',\n        data: {\n          // product_id,\n          'add-to-cart': product_id,\n          // quantity: 1,\n          slw_add_to_cart_item_stock_location: SLW_Store.term_id,\n        },\n        success() {\n          $(document.body).trigger('wc_fragment_refresh');\n          setTimeout(() => {\n            $button.removeClass('loading');\n          }, 1500)\n        },\n        error(e) {\n          console.log(e)\n        }\n      })\n    })\n  }\n\n  const outofstockHandle = () => {\n    $('.product.type-product').each(function() {\n      if($(this).find('.product-unavailable-tag').length > 0) return;\n      if($(this).hasClass(`__slwc-qty-${w.SLW_Store.term_id}_0`)) {\n        $(this).append(`<small class=\"product-unavailable-tag\">Out of stock</small>`);\n      }\n    })\n  }\n\n  const _Init = () => {\n    w.SLW_Store = defineClientStoreValue(); // get Store\n    storeSelected();\n    productVariableUpdate();\n    stockLocationSelectFieldUpdate();\n    buttonAddToCart2();\n    outofstockHandle();\n  }\n\n  w.addEventListener('DOMContentLoaded', e => {\n    if(PHP_DATA.site_code == '') _Init();\n  })\n})(window, jQuery)\n"],"names":["w","$","disableBtnCheckout","warrningDialogUpdateLocationPrivate","$shipDifferentAddressCheckbox","$countryField","$countryField2","$formCheckout","alertMessage","countryCode","PHP_DATA","site_code","alert","title","content","slwc_message_warning_checkout_page","useBootstrap","type","find","prop","setInterval","disableBN","document","length","clearInterval","on","e","this","value","submit","val","addEventListener","window","jQuery","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prototype","hasOwnProperty","call","SLW_Store","AllStore","product_locations","country","timezone","user_location","storeSelected","selectQuery","selectFields","querySelectorAll","join","addClass","off","select","$wrap","parent","$opt","text","remove","prepend","updateTextNearbyLocationSelect","$select","$form","parents","disabled","removeClass","validateQtyAfterLocalSelectUpdate","forEach","classList","add","term_id","trigger","buttonAddToCart2","each","_","b","product_id","parseInt","dataset","isUnavailable","ButtonClone","before","href","body","preventDefault","$button","data","ajax","url","slw_add_to_cart_item_stock_location","success","setTimeout","error","console","log","outofstockHandle","hasClass","append","store","country_code","access_store","ajaxComplete","event","request","settings","startsWith"],"sourceRoot":""}